(this.webpackJsonpgame=this.webpackJsonpgame||[]).push([[0],{62:function(e,t,n){e.exports=n(79)},66:function(e,t,n){},68:function(e,t,n){},79:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(27),u=n.n(c),o=(n(66),n(8)),i=n(9),l=n(0),s=Object(r.forwardRef)((function(e,t){var n=e.position,c=Object(i.g)(l.TextureLoader,["./Background/orangeTexture.png","./Background/redTexture.png","./Background/whiteTexture.png","./Background/yellowTexture.png","./Background/greenTexture.png","./Background/blueTexture.png"]),u=Object(r.useRef)(),s=[],f=Object(r.useState)([1===n.x?c[0]:null,-1===n.x?c[1]:null,1===n.y?c[2]:null,-1===n.y?c[3]:null,1===n.z?c[4]:null,-1===n.z?c[5]:null]),b=Object(o.a)(f,1)[0];return s.push(b.map((function(e,t){return a.a.createElement("meshStandardMaterial",{attachArray:"material",map:e,color:e?null:"black",metalness:0,roughness:0,clearcoat:1,reflectivity:1})}))),a.a.createElement("group",{ref:t,position:Object.values(n)},a.a.createElement("mesh",{ref:u},a.a.createElement("boxBufferGeometry",{args:[1,1,1]}),s))})),f=n(28),b=function(e){var t=Object.values(e).map((function(e){return Math.abs(e)})),n=t.indexOf(Math.max.apply(Math,t));return Object.keys(e)[n]},p=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)};function m(e,t,n,r,a,c){var u=(a.current?r[n]-a.current[n]:r[n])>=0?1:-1;return("z"==e&&"y"==n||"x"==e&&"y"==n||"y"==e&&"x"==n)&&(u*=-1),("x"==e&&1===t||"y"==e&&-1===t||"z"==e&&-1===t)&&(u*=-1),console.log(u),u}var d={cubeFaceClicked:null,initialCubeClicked:null,rubikCubeSide:null,finalCube:null,rotateAxis:null,direction:null},g=function(e,t){switch(t.type){case"start_movement_point":return{cubeFaceClicked:t.cubeFaceClicked,initialCubeClicked:t.initialCubeClicked,rubikCubeSide:t.rubikCubeSide,finalCube:null};case"trace_movement_destination":return Object(f.a)(Object(f.a)({},e),{},{finalCube:t.finalCube});case"rotate_movement":return Object(f.a)(Object(f.a)({},e),{},{rotateAxis:t.rotateAxis,direction:t.direction});case"auto_rotate":return Object(f.a)(Object(f.a)({},e),{},{initialCubeClicked:t.initialCubeClicked,rotateAxis:t.rotateAxis,direction:t.direction});case"finish_movement":return{initialState:d};default:return null}},j=function(){var e=Object(r.useReducer)(g,d),t=Object(o.a)(e,2),n=t[0],a=n.cubeFaceClicked,c=n.initialCubeClicked,u=n.rubikCubeSide,i=n.finalCube,l=n.rotateAxis,s=n.direction,f=t[1],p=Object(r.useRef)();return Object(r.useEffect)((function(){if(c&&i){var e={x:i.x-c.x,y:i.y-c.y,z:i.z-c.z},t=b(e);Math.abs(e[t])>.2&&(f({type:"rotate_movement",rotateAxis:l||{x:{y:"z",z:"y"},y:{x:"z",z:"x"},z:{x:"y",y:"x"}}[a][t],direction:m(a,u,t,e,p)}),p.current=e)}}),[i]),Object(r.useEffect)((function(){l||(p.current=null)}),[l]),[l,c,s,f]},O=function(e,t,n,a){var c=Object(r.useState)(!1),u=Object(o.a)(c,2),i=u[0],l=u[1],s=Object(r.useRef)(),f=Object(r.useCallback)((function(t){return l(!0),a(!0),t.stopPropagation(),e&&e(t),t.target.setPointerCapture(t.pointerId),console.log(t.pointerId)}),[e,a]),b=Object(r.useCallback)((function(e){return l(!1),a(!1),e.target.releasePointerCapture(e.pointerId),n&&n(e)}),[n,a]),p=Object(r.useCallback)((function(e){return s.current&&(e.stopPropagation(),t(e))}),[t]);return Object(r.useEffect)((function(){s.current=i})),[i,{onPointerDown:f,onPointerUp:b,onPointerMove:p}]},h=n(16);function v(e,t){var n=e.past,r=e.present,a=e.future,c=(t.type,t.newPresent);switch(t.type){case"UNDO":if(0===n.length)return e;var u=n[n.length-1];return{past:n.slice(0,n.length-1),present:u,future:[r].concat(Object(h.a)(a))};case"REDO":if(0===a.length)return e;var o=a[0],i=a.slice(1);return{past:[].concat(Object(h.a)(n),[r]),present:o,future:i};case"SET":return c===r?e:{past:[].concat(Object(h.a)(n),[r]),present:c,future:[]};case"RESET":return{past:[],present:c,future:[]}}}var k=function(e){var t=e.blockRubikCubeRotation,n=e.onShuffle,c=e.onUndo,u=e.onRedo,f=e.onSolve,m=j(),d=Object(o.a)(m,4),g=d[0],h=d[1],k=d[2],C=d[3],E=function(e){var t=a.a.useReducer(v,{past:[],present:e,future:[]}),n=Object(o.a)(t,2),r=n[0],c=n[1],u=0!==r.past.length,i=0!==r.future.length,l=a.a.useCallback((function(){return c({type:"UNDO"})}),[]),s=a.a.useCallback((function(){return c({type:"REDO"})}),[]);return[r,{set:a.a.useCallback((function(e){return c({type:"SET",newPresent:e})}),[]),reset:a.a.useCallback((function(e){return c({type:"RESET",newPresent:e})}),[]),undo:l,redo:s,canUndo:u,canRedo:i}]}([]),y=Object(o.a)(E,2),x=y[0],M=y[1],R=M.set,S=M.reset,B=M.undo,w=M.redo,P=M.canUndo,z=M.canRedo,T=Object(r.useState)([]),_=Object(o.a)(T,2),A=_[0],F=_[1],I=Object(r.useState)(0),D=Object(o.a)(I,2),U=D[0],L=D[1],W=Object(r.useState)([]),G=Object(o.a)(W,2),N=G[0],J=G[1],V=Object(r.useRef)(),Z=Object(r.useRef)();Object(r.useEffect)((function(){for(var e=[],t=0;t<3;t++)for(var n=0;n<3;n++)for(var r=0;r<3;r++){var c=1*(t-1),u=1*(n-1),o=1*(r-1);e.push(a.a.createElement(s,{key:e.length,position:{x:c,y:u,z:o}}))}F(e)}),[]);var $=O((function(e){if(!H&&!g){var t=b(e.intersections[0].point);C({type:"start_movement_point",cubeFaceClicked:t,initialCubeClicked:e.intersections[0].point,rubikCubeSide:Math.sign(e.intersections[0].point[t])})}}),(function(e){H&&Math.abs(U)<Math.PI/2&&(C({type:"trace_movement_destination",finalCube:e.intersections[0].point}),h!==e.intersections[0].point&&g&&Q(.025))}),null,t),q=Object(o.a)($,2),H=q[0],K=q[1];function Q(e){Z.current.rotation[g]=k*e,Z.current.updateMatrixWorld(),L((function(t){return t+k*e})),A.forEach((function(e,t){Math.round(V.current.children[t].getWorldPosition(new l.Vector3)[g])===Math.round(h[g])&&V.current.children[t].applyMatrix4(Z.current.matrixWorld)}))}return Object(i.f)((function(){g&&!H&&(Math.abs(U)<Math.PI/2?Q(.125):(Q(-1*(Math.abs(U)-Math.PI/2)),0!==N.length?J((function(e){return e.slice(1,e.length)})):R([h,g,k]),C({type:"finish_movement"}),Z.current.rotation[g]=0,L(0)))})),n((function(){for(var e=[],t=0;t<=p(20,40);t++){var n=[A[p(0,A.length-1)].props.position,["x","y","z"][p(0,2)],Math.round(Math.random())?1:-1];e.push(n),R(n)}J(e)})),c((function(){P&&(J([[x.present[0],x.present[1],-1*x.present[2]]]),B())})),u((function(){z&&(J([x.future[0]]),w())})),f((function(){if(P){var e=x.past.map((function(e){return e.map((function(e,t){return 2===t?e*=-1:e}))})),t=[x.present[0],x.present[1],-1*x.present[2]];J([t].concat(e.reverse().slice(0,e.length-1))),S([])}})),Object(r.useEffect)((function(){if(0!==N.length){var e=N[0];C({type:"auto_rotate",initialCubeClicked:e[0],rotateAxis:e[1],direction:e[2]})}}),[N]),a.a.createElement(a.a.Fragment,null,a.a.createElement("group",Object.assign({rotation:[0,0,0],name:"group"},K,{ref:V}),A),a.a.createElement("group",{ref:Z,position:[0,0,0],name:"pivot"}))},C=function(){return a.a.createElement("group",null,a.a.createElement("hemisphereLight",{skyColor:"#ffffff",groundColor:"#ffffff",intensity:.7}))};function E(){var e=Object(i.i)(),t=e.scene,n=(e.gl,Object(i.g)(l.CubeTextureLoader,[["Background/1.jpg","Background/2.jpg","Background/3.jpg","Background/4.jpg","Background/5.jpg","Background/6.jpg"]])),a=Object(o.a)(n,1)[0];return Object(r.useLayoutEffect)((function(){a.encoding=l.sRGBEncoding;var e=t.background,n=t.environment;return t.background=a,t.environment=a,function(){t.background=e,t.environment=n,a.dispose()}}),[t,a]),null}n(68);var y=function(){var e=Object(i.h)(),t=Object(i.i)(),n=t.scene,c=t.gl,u=Object(r.useState)((function(){return new l.WebGLCubeRenderTarget(256)})),s=Object(o.a)(u,1)[0],f=Object(i.g)(l.TextureLoader,"Background/4.jpg");return Object(i.f)((function(){return e.current.update(c,n)})),a.a.createElement(a.a.Fragment,null,a.a.createElement("cubeCamera",{ref:e,args:[1,1e3,s],position:[0,-7,0]}),a.a.createElement("mesh",{visible:!0,position:[0,-5,0],rotation:[-Math.PI/2,0,0]},a.a.createElement("planeBufferGeometry",{args:[1024,1024],attach:"geometry"}),a.a.createElement("meshBasicMaterial",{envMap:s.texture,opacity:.25,transparent:!0})),a.a.createElement("mesh",{visible:!0,position:[0,-6,0],rotation:[-Math.PI/2,0,0]},a.a.createElement("planeBufferGeometry",{args:[512,512],attach:"geometry"}),a.a.createElement("meshBasicMaterial",{metalness:.4,map:f})))},x=n(35),M=n(58);Object(i.e)({OrbitControls:x.b});var R=function(e){var t=e.rotate,n=Object(i.i)(),c=n.camera,u=n.gl.domElement,o=Object(r.useRef)();return Object(i.f)((function(){o.current.update()})),a.a.createElement("orbitControls",{ref:o,args:[c,u],enableZoom:!0,enableRotate:t,enableDamping:!0,dampingFactor:.05,maxDistance:12,minDistance:6,enablePan:!1})};var S=function(){var e=Object(r.useState)(!1),t=Object(o.a)(e,2),n=t[0],c=t[1],u=Object(r.useRef)(),l=Object(r.useRef)(),s=Object(r.useRef)(),f=Object(r.useRef)();return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"Menu"},a.a.createElement("button",{onClick:function(){return u&&u.current()}},"Shuffle"),a.a.createElement("button",{onClick:function(){return l&&l.current()}},"Undo"),a.a.createElement("button",{onClick:function(){return s&&s.current()}},"Redo"),a.a.createElement("button",{onClick:function(){return f&&f.current()}},"Solve")),a.a.createElement(i.a,{className:i.a,shadowMap:!0,camera:{position:[7,3,7]}},a.a.createElement(R,{rotate:!n}),a.a.createElement(r.Suspense,{fallback:null},a.a.createElement(k,{onShuffle:function(e){return u.current=e},onUndo:function(e){return l.current=e},onRedo:function(e){return s.current=e},onSolve:function(e){return f.current=e},blockRubikCubeRotation:function(e){c(e)}}),a.a.createElement(y,null),a.a.createElement(E,null)),a.a.createElement(C,null)),a.a.createElement(M.a,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(S,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[62,1,2]]]);
//# sourceMappingURL=main.e0c0d534.chunk.js.map